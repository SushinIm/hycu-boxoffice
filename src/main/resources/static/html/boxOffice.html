<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="../js/util.js"></script>
  <title>박스오피스</title>
</head>
<body>
<div id="head">
  <label for="startDate">From</label> <input type="date" id="startDate"/>
  ~
  <label for="endDate">To</label> <input type="date" id="endDate"/>
  <input type="button" value="조회" id="search"/>
</div>
<hr />
</body>
<script>
  window.onload = () => {
    const requestUrl = "http://localhost:8080/api/box-office";
    let today = new Date();
    let thisYear = today.getFullYear();
    let thisMonth = today.getMonth() + 1;
    let thisDate = today.getDate();
    document.querySelector("#startDate").value = `${thisYear}-${digit2(thisMonth-1)}-${digit2(thisDate)}`;
    document.querySelector("#endDate").value = `${thisYear}-${digit2(thisMonth)}-${digit2(thisDate)}`;
    document.querySelector("#search").addEventListener("click", () => {
      let requestUri = requestUrl;
      let startDate = document.querySelector("#startDate").value;
      let endDate = document.querySelector("#endDate").value;

      requestUri += "?startDate=" + (startDate ? startDate : "");
      requestUri += "&endDate=" + (endDate ? endDate : "");

      if (startDate && endDate) {
        fetch(requestUri)
        .then(res => res.json())
        .then(data => {
          //TODO 결과값을 만들어주는 기능 D3로 제작
          console.log(data);
        });
      } else {
        alert("검색 기준 날짜 범위를 설정해 주십시오.");
      }
    });
  }
</script>
</html>